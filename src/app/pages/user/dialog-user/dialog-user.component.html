<h2 mat-dialog-title class="m-b-24">{{ titulo }}</h2>

<mat-divider></mat-divider>
<mat-dialog-content class="mat-typography" style="max-width: 600px">
  <form [formGroup]="usuarioForm" (ngSubmit)="onSubmit()">
    <mat-form-field appearance="outline" class="w-100">
      <mat-label>Persona</mat-label>
      <input
        type="text"
        placeholder="Buscar y Seleccionar Persona"
        matInput
        [formControl]="firstControl"
        [matAutocomplete]="auto"
      />

      <mat-icon matSuffix>
        <i-tabler name="search" class="icon-20"></i-tabler>
      </mat-icon>

      <mat-autocomplete
        #auto="matAutocomplete"
        [displayWith]="displayPersona"
        (optionSelected)="onPersonaSelected($event.option.value)"
      >
        <mat-option
          *ngFor="let persona of filteredOptions | async"
          [value]="persona"
        >
          {{ persona.nombreCompleto }}
        </mat-option>
      </mat-autocomplete>
    </mat-form-field>

    <div class="row m-t-20">
      <div class="col-lg-6">
        <mat-form-field appearance="outline" class="w-100" color="primary">
          <mat-label>Usuario</mat-label>
          <input
            matInput
            placeholder="Usuario"
            formControlName="username"
            [disabled]="true"
          />
        </mat-form-field>
      </div>

      <div class="col-lg-6">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Contrase√±a</mat-label>
          <input matInput value="[DNI INGRESADO]Aa* " [disabled]="true" />
        </mat-form-field>
      </div>
    </div>

    <div class="row m-t-20">
      <div class="col-lg-6">
        <mat-form-field appearance="outline" class="w-100" color="primary">
          <mat-label>Iniciales</mat-label>
          <input matInput placeholder="Iniciales" formControlName="iniciales" />
        </mat-form-field>
      </div>
    </div>

    <mat-form-field appearance="outline" class="w-100" color="accent">
      <mat-label>Email</mat-label>
      <input
        matInput
        formControlName="email"
        placeholder="Email"
        [disabled]="true"
      />
    </mat-form-field>

    @if (mostrarRol) {
    <mat-form-field appearance="outline" class="w-100">
      <mat-label>Rol</mat-label>
      <mat-select
        formControlName="idRol"
        (selectionChange)="onRolSelected($event.value)"
      >
        <mat-option *ngFor="let e of rols" [value]="e.id">
          {{ e.descripcion }}
        </mat-option>
      </mat-select>
      <mat-error *ngIf="usuarioForm.get('idRol')?.hasError('required')"
        >Campo requerido</mat-error
      >
    </mat-form-field>
    }
  </form>
</mat-dialog-content>

<mat-divider></mat-divider>
<mat-dialog-actions class="p-24">
  <button
    mat-flat-button
    [disabled]="usuarioForm.invalid"
    color="primary"
    (click)="onSubmit()"
  >
    Guardar
  </button>
  <button mat-stroked-button color="warn" mat-dialog-close>Cancelar</button>
</mat-dialog-actions>
