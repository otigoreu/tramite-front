"use strict";(self.webpackChunkModernize=self.webpackChunkModernize||[]).push([[177],{5177:(Di,z,d)=>{d.r(z),d.d(z,{PagesRoutes:()=>Ii});var t=d(3953),l=d(9159),w=d(1626),N=d(3587),j=d(6354);let x=(()=>{class a{constructor(){this.baseUrl=N.c.baseUrl,this.http=(0,t.WQX)(w.Qq)}getPaginadoEntidad(i="",e=1,n=10){return this.http.get(`${this.baseUrl}/api/entidades/descripcion`,{params:{search:i,Page:e,RecordsPerPage:n},observe:"response"}).pipe((0,j.T)(s=>({items:s.body?.data??[],meta:{total:parseInt(s.headers.get("totalrecordsquantity")??"0",10),page:e,pageSize:n}})))}agregarEntidad(i){return this.http.post(`${this.baseUrl}/api/entidades`,i)}actualizarEntidad(i,e){return this.http.put(`${this.baseUrl}/api/entidades/${i}`,e)}eliminarEntidad(i){return this.http.delete(`${this.baseUrl}/api/entidades/${i}`)}deshabilitarEntidad(i){return this.http.patch(`${this.baseUrl}/api/entidades/${i}/finalize`,null)}habilitarEntidad(i){return this.http.patch(`${this.baseUrl}/api/entidades/${i}/initialize`,null)}static#t=this.\u0275fac=function(e){return new(e||a)};static#i=this.\u0275prov=t.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var _=d(6695),v=d(2042),F=d(7797),E=d(4912),b=d(6600),G=d(3690),f=d(177),h=d(856),c=d(9417);let A=(()=>{class a{static#t=this.\u0275fac=function(e){return new(e||a)};static#i=this.\u0275mod=t.$C({type:a});static#a=this.\u0275inj=t.G2t({imports:[f.MD]})}return a})();var H=d(6721),k=d(6806),p=d(4006),y=d(5416),g=d(2102),T=d(9631),$=d(1997),U=d(8834);let M=(()=>{class a{handleEnter(i){i.preventDefault();const e=Array.from(document.querySelectorAll('input, select, textarea, button, [tabindex]:not([tabindex="-1"])')),n=e.findIndex(o=>o===i.target);for(let o=n+1;o<e.length;o++){const s=e[o];if(!s.hasAttribute("disabled")&&!s.hasAttribute("readonly")&&this.isVisible(s)){s.focus();break}}}isVisible(i){return!!(i.offsetWidth||i.offsetHeight||i.getClientRects().length)}static#t=this.\u0275fac=function(e){return new(e||a)};static#i=this.\u0275dir=t.FsC({type:a,selectors:[["","appEnterKeyFocus",""]],hostBindings:function(e,n){1&e&&t.bIt("keydown.enter",function(s){return n.handleEnter(s)})}})}return a})();function L(a,r){1&a&&(t.j41(0,"div",10),t.EFF(1,"Nombre(s) "),t.j41(2,"strong"),t.EFF(3,"requeridos"),t.k0s()())}function J(a,r){if(1&a&&(t.j41(0,"mat-hint",5),t.DNE(1,L,4,0,"div",10),t.k0s()),2&a){const i=t.XpG();t.R7$(),t.vxM(i.entidadForm.controls.descripcion.hasError("required")?1:-1)}}function q(a,r){1&a&&(t.j41(0,"div",10),t.EFF(1,"Ruc "),t.j41(2,"strong"),t.EFF(3,"requerido"),t.k0s()())}function Z(a,r){1&a&&(t.j41(0,"div",10),t.EFF(1,"RUC debe tener "),t.j41(2,"strong"),t.EFF(3,"11 d\xedgitos"),t.k0s()())}function K(a,r){1&a&&(t.j41(0,"div",10),t.EFF(1," RUC debe contener "),t.j41(2,"strong"),t.EFF(3,"solo n\xfameros"),t.k0s()())}function tt(a,r){if(1&a&&(t.j41(0,"mat-hint",5),t.DNE(1,q,4,0,"div",10)(2,Z,4,0,"div",10)(3,K,4,0,"div",10),t.k0s()),2&a){const i=t.XpG();t.R7$(),t.vxM(i.entidadForm.controls.ruc.hasError("required")?1:i.entidadForm.controls.ruc.hasError("minlength")||i.entidadForm.controls.ruc.hasError("maxlength")?2:i.entidadForm.controls.ruc.hasError("pattern")?3:-1)}}let it=(()=>{class a{constructor(i,e){this.data=i,this._snackBar=e,this.entidadForm=new c.gE({descripcion:new c.MJ("",c.k0.required),ruc:new c.MJ("",[c.k0.required,c.k0.pattern(/^\d{1,11}$/)])}),this.dialogRef=(0,t.WQX)(p.CP),this.entidadService=(0,t.WQX)(x),this.notificationsService=(0,t.WQX)(k.I2),this.titulo=""}ngOnInit(){const i=!!this.data?.id;if(this.titulo=i?"Actualizar ENTIDAD":"Agregar nueva ENTIDAD",i){const e={...this.data};this.entidadForm.patchValue({descripcion:e.descripcion,ruc:e.ruc})}}onSubmit(){if(this.entidadForm.invalid)return;const i={descripcion:this.entidadForm.value.descripcion,ruc:this.entidadForm.value.ruc},e=!!this.data?.id;(e?this.entidadService.actualizarEntidad(this.data.id,i):this.entidadService.agregarEntidad(i)).subscribe({next:o=>{if(o.success){const s=e?h.I.successActualizar("ENTIDAD"):h.I.successCrear("ENTIDAD");this.notificationsService.success(...s),this.dialogRef.close(!!e||o.data)}else this._snackBar.open(o.errorMessage||"Error desconocido","Cerrar",{duration:3e3})},error:o=>{this._snackBar.open("Error del servidor","Cerrar",{duration:3e3}),console.error(o)}})}static#t=this.\u0275fac=function(e){return new(e||a)(t.rXU(p.Vh),t.rXU(y.UG))};static#i=this.\u0275cmp=t.VBU({type:a,selectors:[["app-entidad-edit"]],standalone:!0,features:[t.Jv_([(0,b.aw)(),{provide:b.Ju,useValue:"es-ES"},{provide:b.MJ,useClass:H.z}]),t.aNF],decls:21,vars:6,consts:[["mat-dialog-title","",1,"m-b-24"],[1,"mat-typography",2,"max-width","600px"],[3,"formGroup"],["appearance","outline",1,"w-100"],["matInput","","required","","placeholder","Nombres","formControlName","descripcion","appEnterKeyFocus",""],[1,"m-b-16","error-msg"],["matInput","","required","","placeholder","RUC","formControlName","ruc","appEnterKeyFocus","","minlength","11","maxlength","11","inputmode","numeric","pattern","\\d*"],[1,"p-24"],["mat-flat-button","","color","primary",3,"click","mat-dialog-close","disabled"],["mat-stroked-button","","color","warn","mat-dialog-close",""],[1,"text-error"]],template:function(e,n){1&e&&(t.j41(0,"h2",0),t.EFF(1),t.k0s(),t.nrm(2,"mat-divider"),t.j41(3,"mat-dialog-content",1)(4,"form",2)(5,"mat-form-field",3)(6,"mat-label"),t.EFF(7,"Descripcion"),t.k0s(),t.nrm(8,"input",4),t.DNE(9,J,2,1,"mat-hint",5),t.k0s(),t.j41(10,"mat-form-field",3)(11,"mat-label"),t.EFF(12,"Ruc"),t.k0s(),t.nrm(13,"input",6),t.DNE(14,tt,4,1,"mat-hint",5),t.k0s()()(),t.nrm(15,"mat-divider"),t.j41(16,"mat-dialog-actions",7)(17,"button",8),t.bIt("click",function(){return n.onSubmit()}),t.EFF(18," Guardar "),t.k0s(),t.j41(19,"button",9),t.EFF(20,"Cancelar"),t.k0s()()),2&e&&(t.R7$(),t.JRh(n.titulo),t.R7$(3),t.Y8G("formGroup",n.entidadForm),t.R7$(5),t.vxM(n.entidadForm.controls.descripcion.touched&&n.entidadForm.controls.descripcion.invalid?9:-1),t.R7$(5),t.vxM(n.entidadForm.controls.ruc.touched&&n.entidadForm.controls.ruc.invalid?14:-1),t.R7$(3),t.Y8G("mat-dialog-close",!0)("disabled",n.entidadForm.invalid))},dependencies:[F.G,g.rl,g.nJ,g.MV,T.fg,$.q,U.$z,p.tx,p.BI,p.E7,p.Yi,c.YN,c.qT,c.me,c.BC,c.cb,c.YS,c.xh,c.tU,c.R_,b.WX,c.X1,c.j4,c.JD,A,M,E.X4],encapsulation:2})}return a})();var S=d(5596),D=d(3902);let at=(()=>{class a{constructor(){this.baseUrl=N.c.baseUrl,this.http=(0,t.WQX)(w.Qq)}getPaginadoEntidadAplicacion(i,e="",n=1,o=10){return this.http.get(`${this.baseUrl}/api/EntidadAplicacion/entidad/${i}/aplicaciones`,{params:{idEntidad:i,search:e,Page:n,RecordsPerPage:o},observe:"response"}).pipe((0,j.T)(m=>({data:m.body?.data??[],meta:{total:parseInt(m.headers.get("totalrecordsquantity")??"0",10),page:n,pageSize:o}})))}agregarEntidadAplicacion(i){return this.http.post(`${this.baseUrl}/api/EntidadAplicacion`,i)}actualizarEntidadAplicacion(i,e){return this.http.put(`${this.baseUrl}/api/EntidadAplicacion/${i}`,e)}getEntidadAplicacion(i,e){return this.http.get(`${this.baseUrl}/api/EntidadAplicacion/entidad/${i}/aplicacion/${e}`)}static#t=this.\u0275fac=function(e){return new(e||a)};static#i=this.\u0275prov=t.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var R=d(9213);const et=(a,r)=>r.idAplicacion,nt=()=>[10,15,20];function ot(a,r){if(1&a){const i=t.RV6();t.j41(0,"mat-list-option",11),t.bIt("selectedChange",function(n){const o=t.eBV(i).$implicit,s=t.XpG();return t.Njj(s.onSelectedChange(o,n))}),t.EFF(1),t.k0s()}if(2&a){const i=r.$implicit,e=r.$index;t.Y8G("selected",!0===i.estado),t.R7$(),t.LHq(" ",i.descripcionAplicacion," - Index: ",e," - idAplicacion: ",i.idAplicacion," / ",i.estado," ")}}let rt=(()=>{class a{constructor(i){this.data=i,this.enaplicaService=(0,t.WQX)(at),this.notificationsService=(0,t.WQX)(k.I2),this.dialogRef=(0,t.WQX)(p.CP),this.snackBar=(0,t.WQX)(y.UG),this.entidadDescripcion="",this.aplicaciones=(0,t.vPA)([]),this.totalRecords=0,this.searchTerm="",this.currentPage=1,this.currentPageSize=10,this.isLoading=!1}ngOnInit(){this.entidadDescripcion=this.data?.descripcion,this.loadEntidadAplicaciones(this.data?.id)}get seleccionadas(){return this.aplicaciones().filter(i=>i.estado).length}loadEntidadAplicaciones(i,e="",n=1,o=10){this.aplicaciones.set([]),this.isLoading=!0,this.enaplicaService.getPaginadoEntidadAplicacion(i,e,n,o).subscribe({next:s=>{this.totalRecords=s.meta.total,this.aplicaciones.set(s.data),setTimeout(()=>{this.isLoading=!1},300)},error:s=>{console.error("Error al obtener aplicaciones",s),this.isLoading=!1}})}onSearch(i){this.searchTerm=i.trim(),this.loadEntidadAplicaciones(this.data?.id,this.searchTerm,this.currentPage,this.currentPageSize)}onSelectedChange(i,e){if(this.isLoading)return;const n={idEntidad:this.data?.id,idAplicacion:i.idAplicacion,estado:e};this.enaplicaService.getEntidadAplicacion(n.idEntidad,n.idAplicacion).subscribe({next:o=>{const s=o.success&&null!=o.data?.id;(s?this.enaplicaService.actualizarEntidadAplicacion(o.data.id,n):this.enaplicaService.agregarEntidadAplicacion(n)).subscribe({next:u=>{if(u.success){const[C,V]=s?h.I.successActualizar("ENTIDAD-APLICACION"):h.I.successCrear("ENTIDAD-APLICACION");this.aplicaciones.update(O=>O.map(I=>I.idAplicacion===i.idAplicacion?{...I,estado:e}:I)),this.snackBar.open(V,"Cerrar",{duration:3e3})}else this.snackBar.open(u.errorMessage||"Error desconocido","Cerrar",{duration:3e3})},error:u=>{this.snackBar.open("Error del servidor","Cerrar",{duration:3e3}),console.error(u)}})},error:o=>{this.snackBar.open("Error al consultar aplicaci\xf3n","Cerrar",{duration:3e3}),console.error(o)}})}onPageChange(i){this.currentPage=i.pageIndex+1,this.currentPageSize=i.pageSize,this.loadEntidadAplicaciones(this.data?.id,this.searchTerm,this.currentPage,this.currentPageSize)}static#t=this.\u0275fac=function(e){return new(e||a)(t.rXU(p.Vh))};static#i=this.\u0275cmp=t.VBU({type:a,selectors:[["app-entidad-aplicacion"]],viewQuery:function(e,n){if(1&e&&(t.GBs(_.iy,5),t.GBs(v.B4,5)),2&e){let o;t.mGM(o=t.lsd())&&(n.paginator=o.first),t.mGM(o=t.lsd())&&(n.sort=o.first)}},standalone:!0,features:[t.aNF],decls:18,vars:6,consts:[["mat-dialog-title","",1,"m-b-24"],[1,"mat-typography",2,"max-width","600px"],["appearance","outline",1,"w-100","hide-hint"],["matInput","","placeholder","Buscar Aplicaci\xf3n",3,"keyup"],["matSuffix",""],["name","search",1,"icon-20"],[3,"selected"],[1,"mat-subtitle-2","f-w-600","p-16","bg-light-primary","rounded"],["showFirstLastButtons","",3,"page","length","pageSize","pageSizeOptions"],[1,"p-24"],["mat-stroked-button","","color","warn","mat-dialog-close",""],[3,"selectedChange","selected"]],template:function(e,n){1&e&&(t.j41(0,"h2",0),t.EFF(1),t.k0s(),t.nrm(2,"mat-divider"),t.j41(3,"mat-dialog-content",1)(4,"mat-form-field",2)(5,"input",3),t.bIt("keyup",function(s){return n.onSearch(s.target.value)}),t.k0s(),t.j41(6,"mat-icon",4),t.nrm(7,"i-tabler",5),t.k0s()(),t.j41(8,"mat-selection-list"),t.Z7z(9,ot,2,5,"mat-list-option",6,et),t.k0s(),t.j41(11,"p",7),t.EFF(12),t.k0s(),t.j41(13,"mat-paginator",8),t.bIt("page",function(s){return n.onPageChange(s)}),t.k0s()(),t.nrm(14,"mat-divider"),t.j41(15,"mat-dialog-actions",9)(16,"button",10),t.EFF(17,"Cancelar"),t.k0s()()),2&e&&(t.R7$(),t.JRh(n.entidadDescripcion),t.R7$(8),t.Dyx(n.aplicaciones()),t.R7$(3),t.SpI(" Opciones seleccionadas: ",n.seleccionadas," "),t.R7$(),t.Y8G("length",n.totalRecords)("pageSize",10)("pageSizeOptions",t.lJ4(5,nt)))},dependencies:[f.MD,c.X1,c.YN,D.Fg,D.p6,D.oh,$.q,S.Hu,F.G,g.rl,g.yw,T.fg,U.$z,R.An,p.tx,p.BI,p.E7,p.Yi,_.iy,b.WX,A,E.X4,E.Jc],encapsulation:2,changeDetection:0})}return a})();var st=d(8032),B=d.n(st);let P=(()=>{class a{confirmAndExecute(i,e,n,o){B().fire({title:"\xbfEst\xe1s seguro?",text:i,icon:"warning",showCancelButton:!0,confirmButtonText:"S\xed, Confirmar",cancelButtonText:"Cancelar"}).then(s=>{s.isConfirmed&&e.subscribe({next:m=>{n(m),o&&B().fire("\xc9xito",o,"success")},error:m=>{console.error("Error al ejecutar acci\xf3n",m),B().fire("Error","Ocurri\xf3 un error al procesar la acci\xf3n.","error")}})})}static#t=this.\u0275fac=function(e){return new(e||a)};static#i=this.\u0275prov=t.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var X=d(4823);const ct=()=>[10,15,20];function dt(a,r){1&a&&(t.j41(0,"th",24),t.EFF(1," Descripci\xf3n "),t.k0s())}function lt(a,r){if(1&a&&(t.j41(0,"td",25),t.EFF(1),t.k0s()),2&a){const i=r.$implicit;t.R7$(),t.SpI(" ",i.descripcion," ")}}function pt(a,r){1&a&&(t.j41(0,"th",24),t.EFF(1," Aplicaci\xf3n(s) "),t.k0s())}function mt(a,r){if(1&a){const i=t.RV6();t.j41(0,"td",25)(1,"button",26),t.bIt("click",function(){const n=t.eBV(i).$implicit,o=t.XpG();return t.Njj(o.openDialogAplicacion(n))}),t.EFF(2),t.k0s()()}if(2&a){const i=r.$implicit;t.R7$(2),t.SpI(" ",i.cantidadAplicaciones," + Aplica ")}}function ut(a,r){1&a&&(t.j41(0,"th",24),t.EFF(1," Estado "),t.k0s())}function ht(a,r){1&a&&t.nrm(0,"div",28)}function gt(a,r){1&a&&(t.j41(0,"span",29),t.EFF(1,"Activo"),t.k0s())}function ft(a,r){1&a&&(t.j41(0,"span",30),t.EFF(1,"Inactivo"),t.k0s())}function _t(a,r){if(1&a&&(t.j41(0,"td",25),t.DNE(1,ht,1,0,"div",27)(2,gt,2,0,"ng-template",null,0,t.C5r)(4,ft,2,0,"ng-template",null,1,t.C5r),t.k0s()),2&a){const i=r.$implicit,e=t.sdS(3),n=t.sdS(5);t.R7$(),t.Y8G("ngIf",i.estado)("ngIfThen",e)("ngIfElse",n)}}function Et(a,r){1&a&&(t.j41(0,"th",24),t.EFF(1," Acciones "),t.k0s())}function bt(a,r){if(1&a){const i=t.RV6();t.j41(0,"a",38),t.bIt("click",function(){t.eBV(i);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.habilitarEntidad(n.id))}),t.nrm(1,"i-tabler",39),t.k0s()}}function Ct(a,r){if(1&a){const i=t.RV6();t.j41(0,"a",40),t.bIt("click",function(){t.eBV(i);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.deshabilitarEntidad(n.id))}),t.nrm(1,"i-tabler",41),t.k0s()}}function vt(a,r){if(1&a){const i=t.RV6();t.j41(0,"td",31)(1,"a",32),t.bIt("click",function(){const n=t.eBV(i).$implicit,o=t.XpG();return t.Njj(o.openDialog(n))}),t.nrm(2,"i-tabler",33),t.k0s(),t.j41(3,"a",34),t.bIt("click",function(){const n=t.eBV(i).$implicit,o=t.XpG();return t.Njj(o.eliminarEntidad(n.id))}),t.nrm(4,"i-tabler",35),t.k0s(),t.DNE(5,bt,2,0,"a",36)(6,Ct,2,0,"a",37),t.k0s()}if(2&a){const i=r.$implicit;t.R7$(5),t.vxM(i.estado?6:5)}}function Ft(a,r){1&a&&t.nrm(0,"tr",42)}function kt(a,r){1&a&&t.nrm(0,"tr",43)}let Tt=(()=>{class a{constructor(i,e){this.notificationsService=i,this.confirmationService=e,this.entidadService=(0,t.WQX)(x),this.displayedColumns=["descripcion","aplicacion","estado","actions"],this.dataSource=new l.I6,this.totalRecords=0,this.searchTerm="",this.dialog=(0,t.WQX)(p.bZ)}ngOnInit(){this.loadEntidades()}ngAfterViewInit(){this.paginator.page.subscribe(()=>{this.loadEntidades(this.searchTerm,this.paginator.pageIndex+1,this.paginator.pageSize)})}loadEntidades(i="",e=1,n=10){this.entidadService.getPaginadoEntidad(i,e,n).subscribe({next:o=>{this.totalRecords=o.meta.total,this.dataSource.data=o.items},error:o=>{console.error("Error al obtener entidades",o)}})}onSearch(i){this.searchTerm=i.trim(),this.paginator.firstPage(),this.loadEntidades(this.searchTerm)}openDialog(i){this.dialog.open(it,{data:i}).afterClosed().subscribe(()=>{this.loadEntidades(this.searchTerm,this.paginator.pageIndex+1,this.paginator.pageSize)})}openDialogAplicacion(i){this.dialog.open(rt,{data:i}).afterClosed().subscribe(()=>{this.loadEntidades(this.searchTerm,this.paginator.pageIndex+1,this.paginator.pageSize)})}eliminarEntidad(i){this.confirmationService.confirmAndExecute("\xa1No podr\xe1s revertir esto!",this.entidadService.eliminarEntidad(i),e=>{e.success&&(this.notificationsService.success(...h.I.success()),this.loadEntidades())})}deshabilitarEntidad(i){this.confirmationService.confirmAndExecute("\xa1No podr\xe1s revertir esto!",this.entidadService.deshabilitarEntidad(i),e=>{e.success&&(this.notificationsService.success(...h.I.success("Entidad Deshabilitada")),this.loadEntidades())})}habilitarEntidad(i){this.confirmationService.confirmAndExecute("\xa1No podr\xe1s revertir esto!",this.entidadService.habilitarEntidad(i),e=>{e.success&&(this.notificationsService.success(...h.I.success("Entidad Habilitada")),this.loadEntidades())})}static#t=this.\u0275fac=function(e){return new(e||a)(t.rXU(k.I2),t.rXU(P))};static#i=this.\u0275cmp=t.VBU({type:a,selectors:[["app-entidad"]],viewQuery:function(e,n){if(1&e&&(t.GBs(_.iy,5),t.GBs(v.B4,5)),2&e){let o;t.mGM(o=t.lsd())&&(n.paginator=o.first),t.mGM(o=t.lsd())&&(n.sort=o.first)}},standalone:!0,features:[t.aNF],decls:31,vars:6,consts:[["activo",""],["inactivo",""],[1,"cardWithShadow"],[1,"row","justify-content-between"],[1,"col-lg-4"],["appearance","outline",1,"w-100","hide-hint"],["matInput","","placeholder","Buscar Entidad",3,"keyup"],["matSuffix",""],["name","search",1,"icon-20"],[1,"col-lg-4","d-flex","align-items-center","justify-content-end"],["mat-flat-button","","color","primary",3,"click"],[1,"table-responsive"],["mat-table","","matSort","",1,"w-100",3,"dataSource"],["matColumnDef","descripcion"],["mat-header-cell","","class","f-s-16 f-w-600",4,"matHeaderCellDef"],["mat-cell","","class","f-s-14",4,"matCellDef"],["matColumnDef","aplicacion"],[1,"flex","gap-2","justify-end","w-full"],["matColumnDef","estado"],["matColumnDef","actions"],["mat-cell","","class","action-link",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"length","pageSizeOptions"],["mat-header-cell","",1,"f-s-16","f-w-600"],["mat-cell","",1,"f-s-14"],["mat-stroked-button","","color","primary",1,"m-l-auto",3,"click"],["class","d-flex align-items-center gap-12 p-y-14",4,"ngIf","ngIfThen","ngIfElse"],[1,"d-flex","align-items-center","gap-12","p-y-14"],[1,"bg-light-success","text-success","rounded","f-w-600","p-6","p-y-4","f-s-14"],[1,"bg-light-error","text-error","rounded","f-w-600","p-6","p-y-4","f-s-14"],["mat-cell","",1,"action-link"],["matTooltip","Editar","matTooltipPosition","above",1,"m-r-10","cursor-pointer",3,"click"],["name","edit",1,"icon-18"],["matTooltip","Eliminar","matTooltipPosition","below",1,"m-r-10","cursor-pointer",3,"click"],["name","trash",1,"icon-18"],["matTooltip","Habilitar","matTooltipPosition","above",1,"m-r-10","cursor-pointer"],["matTooltip","Deshabilitar","matTooltipPosition","right",1,"m-r-10","cursor-pointer"],["matTooltip","Habilitar","matTooltipPosition","above",1,"m-r-10","cursor-pointer",3,"click"],["name","circle-arrow-up",1,"icon-18"],["matTooltip","Deshabilitar","matTooltipPosition","right",1,"m-r-10","cursor-pointer",3,"click"],["name","circle-arrow-down",1,"icon-18"],["mat-header-row",""],["mat-row",""]],template:function(e,n){1&e&&(t.j41(0,"mat-card",2)(1,"mat-card-content")(2,"div",3)(3,"div",4)(4,"mat-form-field",5)(5,"input",6),t.bIt("keyup",function(s){return n.onSearch(s.target.value)}),t.k0s(),t.j41(6,"mat-icon",7),t.nrm(7,"i-tabler",8),t.k0s()()(),t.j41(8,"div",9)(9,"button",10),t.bIt("click",function(){return n.openDialog()}),t.EFF(10," Nuevo "),t.k0s()()()()(),t.j41(11,"mat-card",2)(12,"mat-card-content")(13,"div",11)(14,"table",12),t.qex(15,13),t.DNE(16,dt,2,0,"th",14)(17,lt,2,1,"td",15),t.bVm(),t.qex(18,16),t.DNE(19,pt,2,0,"th",14)(20,mt,3,1,"td",15),t.bVm(),t.j41(21,"div",17),t.qex(22,18),t.DNE(23,ut,2,0,"th",14)(24,_t,6,3,"td",15),t.bVm(),t.qex(25,19),t.DNE(26,Et,2,0,"th",14)(27,vt,7,1,"td",20),t.bVm(),t.k0s(),t.DNE(28,Ft,1,0,"tr",21)(29,kt,1,0,"tr",22),t.k0s(),t.nrm(30,"mat-paginator",23),t.k0s()()()),2&e&&(t.R7$(14),t.Y8G("dataSource",n.dataSource),t.R7$(14),t.Y8G("matHeaderRowDef",n.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",n.displayedColumns),t.R7$(),t.Y8G("length",n.totalRecords)("pageSizeOptions",t.lJ4(5,ct)))},dependencies:[F.G,g.rl,g.yw,T.fg,S.RN,S.m2,U.$z,R.An,X.oV,_.iy,v.B4,l.Zl,l.tL,l.ji,l.cC,l.YV,l.iL,l.KS,l.$R,l.YZ,l.NB,E.X4,E.Jc,b.WX,G.Id,f.MD,f.bT,_.Ou],styles:["[_nghost-%COMP%]{display:block}.mat-column-aplicacion[_ngcontent-%COMP%], .mat-column-estado[_ngcontent-%COMP%], .mat-column-actions[_ngcontent-%COMP%]{width:7%}"],changeDetection:0})}return a})();var Y=d(8006);function Ut(a,r){1&a&&(t.j41(0,"div",9),t.EFF(1,"Nombre(s) "),t.j41(2,"strong"),t.EFF(3,"requeridos"),t.k0s()())}function St(a,r){if(1&a&&(t.j41(0,"mat-hint",5),t.DNE(1,Ut,4,0,"div",9),t.k0s()),2&a){const i=t.XpG();t.R7$(),t.vxM(i.aplicacionForm.controls.descripcion.hasError("required")?1:-1)}}let It=(()=>{class a{constructor(i,e){this.data=i,this._snackBar=e,this.aplicacionForm=new c.gE({descripcion:new c.MJ("",c.k0.required)}),this.dialogRef=(0,t.WQX)(p.CP),this.aplicacionService=(0,t.WQX)(Y.R),this.notificationsService=(0,t.WQX)(k.I2),this.titulo=""}ngOnInit(){const i=!!this.data?.id;if(this.titulo=i?"Actualizar APLICACION":"Agregar nueva APLICACION",i){const e={...this.data};this.aplicacionForm.patchValue({descripcion:e.descripcion})}}guardar(){if(this.aplicacionForm.invalid)return;const i={descripcion:this.aplicacionForm.value.descripcion},e=!!this.data?.id;(e?this.aplicacionService.actualizarAplicacion(this.data.id,i):this.aplicacionService.agregarAplicacion(i)).subscribe({next:o=>{if(o.success){const s=e?h.I.successActualizar("ENTIDAD"):h.I.successCrear("ENTIDAD");this.notificationsService.success(...s),this.dialogRef.close(!!e||o.data)}else this._snackBar.open(o.errorMessage||"Error desconocido","Cerrar",{duration:3e3})},error:o=>{this._snackBar.open("Error del servidor","Cerrar",{duration:3e3}),console.error(o)}})}static#t=this.\u0275fac=function(e){return new(e||a)(t.rXU(p.Vh),t.rXU(y.UG))};static#i=this.\u0275cmp=t.VBU({type:a,selectors:[["app-aplicacion-edit"]],standalone:!0,features:[t.aNF],decls:16,vars:5,consts:[["mat-dialog-title","",1,"m-b-24"],[1,"mat-typography",2,"max-width","600px"],[3,"formGroup"],["appearance","outline",1,"w-100"],["matInput","","required","","placeholder","Nombres","formControlName","descripcion","appEnterKeyFocus",""],[1,"m-b-16","error-msg"],[1,"p-24"],["mat-flat-button","","color","primary",3,"click","mat-dialog-close","disabled"],["mat-stroked-button","","color","warn","mat-dialog-close",""],[1,"text-error"]],template:function(e,n){1&e&&(t.j41(0,"h2",0),t.EFF(1),t.k0s(),t.nrm(2,"mat-divider"),t.j41(3,"mat-dialog-content",1)(4,"form",2)(5,"mat-form-field",3)(6,"mat-label"),t.EFF(7,"Descripcion"),t.k0s(),t.nrm(8,"input",4),t.DNE(9,St,2,1,"mat-hint",5),t.k0s()()(),t.nrm(10,"mat-divider"),t.j41(11,"mat-dialog-actions",6)(12,"button",7),t.bIt("click",function(){return n.guardar()}),t.EFF(13," Guardar "),t.k0s(),t.j41(14,"button",8),t.EFF(15,"Cancelar"),t.k0s()()),2&e&&(t.R7$(),t.JRh(n.titulo),t.R7$(3),t.Y8G("formGroup",n.aplicacionForm),t.R7$(5),t.vxM(n.aplicacionForm.controls.descripcion.touched&&n.aplicacionForm.controls.descripcion.invalid?9:-1),t.R7$(3),t.Y8G("mat-dialog-close",!0)("disabled",n.aplicacionForm.invalid))},dependencies:[F.G,g.rl,g.nJ,g.MV,T.fg,$.q,U.$z,p.tx,p.BI,p.E7,p.Yi,c.YN,c.qT,c.me,c.BC,c.cb,c.YS,b.WX,c.X1,c.j4,c.JD,A,M,E.X4],encapsulation:2,changeDetection:0})}return a})();const Dt=()=>[10,15,20];function jt(a,r){1&a&&(t.j41(0,"th",23),t.EFF(1," Descripci\xf3n "),t.k0s())}function At(a,r){if(1&a&&(t.j41(0,"td",24),t.EFF(1),t.k0s()),2&a){const i=r.$implicit;t.R7$(),t.SpI(" ",i.descripcion," ")}}function yt(a,r){1&a&&(t.j41(0,"th",23),t.EFF(1," Estado "),t.k0s())}function $t(a,r){1&a&&t.nrm(0,"div",26)}function Rt(a,r){1&a&&(t.j41(0,"span",27),t.EFF(1,"Activo"),t.k0s())}function wt(a,r){1&a&&(t.j41(0,"span",28),t.EFF(1,"Inactivo"),t.k0s())}function xt(a,r){if(1&a&&(t.j41(0,"td",24),t.DNE(1,$t,1,0,"div",25)(2,Rt,2,0,"ng-template",null,0,t.C5r)(4,wt,2,0,"ng-template",null,1,t.C5r),t.k0s()),2&a){const i=r.$implicit,e=t.sdS(3),n=t.sdS(5);t.R7$(),t.Y8G("ngIf",i.estado)("ngIfThen",e)("ngIfElse",n)}}function Nt(a,r){1&a&&(t.j41(0,"th",23),t.EFF(1," Acciones "),t.k0s())}function Gt(a,r){if(1&a){const i=t.RV6();t.j41(0,"a",36),t.bIt("click",function(){t.eBV(i);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.habilitarAplicacion(n.id))}),t.nrm(1,"i-tabler",37),t.k0s()}}function Bt(a,r){if(1&a){const i=t.RV6();t.j41(0,"a",38),t.bIt("click",function(){t.eBV(i);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.deshabilitarAplicacion(n.id))}),t.nrm(1,"i-tabler",39),t.k0s()}}function Pt(a,r){if(1&a){const i=t.RV6();t.j41(0,"td",29)(1,"a",30),t.bIt("click",function(){const n=t.eBV(i).$implicit,o=t.XpG();return t.Njj(o.openDialog(n))}),t.nrm(2,"i-tabler",31),t.k0s(),t.j41(3,"a",32),t.bIt("click",function(){const n=t.eBV(i).$implicit,o=t.XpG();return t.Njj(o.eliminarAplicacion(n.id))}),t.nrm(4,"i-tabler",33),t.k0s(),t.DNE(5,Gt,2,0,"a",34)(6,Bt,2,0,"a",35),t.k0s()}if(2&a){const i=r.$implicit;t.R7$(5),t.vxM(i.estado?6:5)}}function Xt(a,r){1&a&&t.nrm(0,"tr",40)}function Vt(a,r){1&a&&t.nrm(0,"tr",41)}let Ot=(()=>{class a{constructor(i,e){this.notificationsService=i,this.confirmationService=e,this.aplicacionService=(0,t.WQX)(Y.R),this.displayedColumns=["descripcion","estado","actions"],this.dataSource=new l.I6,this.totalRecords=0,this.searchTerm="",this.dialog=(0,t.WQX)(p.bZ)}ngOnInit(){this.loadAplicaciones()}ngAfterViewInit(){this.paginator.page.subscribe(()=>{this.loadAplicaciones(this.searchTerm,this.paginator.pageIndex+1,this.paginator.pageSize)})}loadAplicaciones(i="",e=1,n=10){this.aplicacionService.getPaginadoAplicacion(i,e,n).subscribe({next:o=>{this.totalRecords=o.meta.total,this.dataSource.data=o.items},error:o=>{console.error("Error al obtener aplicaciones",o)}})}onSearch(i){this.searchTerm=i.trim(),this.paginator.firstPage(),this.loadAplicaciones(this.searchTerm)}openDialog(i){this.dialog.open(It,{data:i}).afterClosed().subscribe(()=>{this.loadAplicaciones()})}eliminarAplicacion(i){this.confirmationService.confirmAndExecute("\xa1No podr\xe1s revertir esto!",this.aplicacionService.eliminarAplicacion(i),e=>{e.success&&(this.notificationsService.success(...h.I.success()),this.loadAplicaciones())})}deshabilitarAplicacion(i){this.confirmationService.confirmAndExecute("\xa1No podr\xe1s revertir esto!",this.aplicacionService.deshabilitarAplicacion(i),e=>{e.success&&(this.notificationsService.success(...h.I.success("Aplicacion Deshabilitada")),this.loadAplicaciones())})}habilitarAplicacion(i){this.confirmationService.confirmAndExecute("\xa1No podr\xe1s revertir esto!",this.aplicacionService.habilitarAplicacion(i),e=>{e.success&&(this.notificationsService.success(...h.I.success("Aplicacion Habilitada")),this.loadAplicaciones())})}static#t=this.\u0275fac=function(e){return new(e||a)(t.rXU(k.I2),t.rXU(P))};static#i=this.\u0275cmp=t.VBU({type:a,selectors:[["app-aplicacion"]],viewQuery:function(e,n){if(1&e&&(t.GBs(_.iy,5),t.GBs(v.B4,5)),2&e){let o;t.mGM(o=t.lsd())&&(n.paginator=o.first),t.mGM(o=t.lsd())&&(n.sort=o.first)}},standalone:!0,features:[t.aNF],decls:28,vars:6,consts:[["activo",""],["inactivo",""],[1,"cardWithShadow"],[1,"row","justify-content-between"],[1,"col-lg-4"],["appearance","outline",1,"w-100","hide-hint"],["matInput","","placeholder","Buscar Aplicacion",3,"keyup"],["matSuffix",""],["name","search",1,"icon-20"],[1,"col-lg-4","d-flex","align-items-center","justify-content-end"],["mat-flat-button","","color","primary",3,"click"],[1,"table-responsive"],["mat-table","","matSort","",1,"w-100",3,"dataSource"],["matColumnDef","descripcion"],["mat-header-cell","","class","f-s-16 f-w-600",4,"matHeaderCellDef"],["mat-cell","","class","f-s-14",4,"matCellDef"],[1,"flex","gap-2","justify-end","w-full"],["matColumnDef","estado"],["matColumnDef","actions"],["mat-cell","","class","action-link",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"length","pageSizeOptions"],["mat-header-cell","",1,"f-s-16","f-w-600"],["mat-cell","",1,"f-s-14"],["class","d-flex align-items-center gap-12 p-y-14",4,"ngIf","ngIfThen","ngIfElse"],[1,"d-flex","align-items-center","gap-12","p-y-14"],[1,"bg-light-success","text-success","rounded","f-w-600","p-6","p-y-4","f-s-14"],[1,"bg-light-error","text-error","rounded","f-w-600","p-6","p-y-4","f-s-14"],["mat-cell","",1,"action-link"],["matTooltip","Editar","matTooltipPosition","above",1,"m-r-10","cursor-pointer",3,"click"],["name","edit",1,"icon-18"],["matTooltip","Eliminar","matTooltipPosition","below",1,"m-r-10","cursor-pointer",3,"click"],["name","trash",1,"icon-18"],["matTooltip","Habilitar","matTooltipPosition","above",1,"m-r-10","cursor-pointer"],["matTooltip","Deshabilitar","matTooltipPosition","right",1,"m-r-10","cursor-pointer"],["matTooltip","Habilitar","matTooltipPosition","above",1,"m-r-10","cursor-pointer",3,"click"],["name","circle-arrow-up",1,"icon-18"],["matTooltip","Deshabilitar","matTooltipPosition","right",1,"m-r-10","cursor-pointer",3,"click"],["name","circle-arrow-down",1,"icon-18"],["mat-header-row",""],["mat-row",""]],template:function(e,n){1&e&&(t.j41(0,"mat-card",2)(1,"mat-card-content")(2,"div",3)(3,"div",4)(4,"mat-form-field",5)(5,"input",6),t.bIt("keyup",function(s){return n.onSearch(s.target.value)}),t.k0s(),t.j41(6,"mat-icon",7),t.nrm(7,"i-tabler",8),t.k0s()()(),t.j41(8,"div",9)(9,"button",10),t.bIt("click",function(){return n.openDialog()}),t.EFF(10," Nuevo "),t.k0s()()()()(),t.j41(11,"mat-card",2)(12,"mat-card-content")(13,"div",11)(14,"table",12),t.qex(15,13),t.DNE(16,jt,2,0,"th",14)(17,At,2,1,"td",15),t.bVm(),t.j41(18,"div",16),t.qex(19,17),t.DNE(20,yt,2,0,"th",14)(21,xt,6,3,"td",15),t.bVm(),t.qex(22,18),t.DNE(23,Nt,2,0,"th",14)(24,Pt,7,1,"td",19),t.bVm(),t.k0s(),t.DNE(25,Xt,1,0,"tr",20)(26,Vt,1,0,"tr",21),t.k0s(),t.nrm(27,"mat-paginator",22),t.k0s()()()),2&e&&(t.R7$(14),t.Y8G("dataSource",n.dataSource),t.R7$(11),t.Y8G("matHeaderRowDef",n.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",n.displayedColumns),t.R7$(),t.Y8G("length",n.totalRecords)("pageSizeOptions",t.lJ4(5,Dt)))},dependencies:[F.G,g.rl,g.yw,T.fg,S.RN,S.m2,U.$z,R.An,X.oV,_.iy,v.B4,l.Zl,l.tL,l.ji,l.cC,l.YV,l.iL,l.KS,l.$R,l.YZ,l.NB,E.X4,E.Jc,b.WX,G.Id,f.MD,f.bT,_.Ou],styles:["[_nghost-%COMP%]{display:block}.mat-column-estado[_ngcontent-%COMP%], .mat-column-actions[_ngcontent-%COMP%]{width:10%}"],changeDetection:0})}return a})(),Q=(()=>{class a{constructor(){this.baseUrl=N.c.baseUrl,this.http=(0,t.WQX)(w.Qq)}getPaginadoUnidadorganica(i="",e=1,n=10,o){let s={search:i,Page:e,RecordsPerPage:n};return o&&(s.idUnidadorganica=o),this.http.get(`${this.baseUrl}/api/UnidadOrganica/descripcion`,{params:s,observe:"response"}).pipe((0,j.T)(m=>({items:m.body?.data??[],meta:{total:parseInt(m.headers.get("totalrecordsquantity")??"0",10),page:e,pageSize:n}})))}agregarUnidadorganica(i){return this.http.post(`${this.baseUrl}/api/UnidadOrganica`,i)}actualizarUnidadorganica(i,e){return this.http.put(`${this.baseUrl}/api/UnidadOrganica/${i}`,e)}eliminarUnidadorganica(i){return this.http.delete(`${this.baseUrl}/api/UnidadOrganica/${i}`)}deshabilitarUnidadorganica(i){return this.http.patch(`${this.baseUrl}/api/UnidadOrganica/${i}/finalize`,null)}habilitarUnidadorganica(i){return this.http.patch(`${this.baseUrl}/api/UnidadOrganica/${i}/initialize`,null)}static#t=this.\u0275fac=function(e){return new(e||a)};static#i=this.\u0275prov=t.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();var zt=d(2798);function Mt(a,r){if(1&a&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&a){const i=r.$implicit;t.Y8G("value",i.id),t.R7$(),t.SpI(" ",i.descripcion," ")}}function Yt(a,r){1&a&&(t.j41(0,"mat-error"),t.EFF(1,"Campo requerido"),t.k0s())}function Qt(a,r){if(1&a&&(t.j41(0,"mat-option",12),t.EFF(1),t.k0s()),2&a){const i=r.$implicit;t.Y8G("value",i.id),t.R7$(),t.SpI(" ",i.descripcion," ")}}function Wt(a,r){1&a&&(t.j41(0,"mat-error"),t.EFF(1,"Campo requerido"),t.k0s())}function Ht(a,r){1&a&&(t.j41(0,"mat-error"),t.EFF(1,"Campo requerido"),t.k0s())}let Lt=(()=>{class a{constructor(i,e,n){this.data=i,this._snackBar=e,this.fb=n,this.notificationsService=(0,t.WQX)(k.I2),this.dialogRef=(0,t.WQX)(p.CP),this.entidades=[],this.unidadorganicas=[],this.entidadService=(0,t.WQX)(x),this.unidadorganicaService=(0,t.WQX)(Q),this.uoForm=this.fb.group({descripcion:["",c.k0.required],idEntidad:[null,c.k0.required],idDependencia:[null]}),this.titulo=""}ngOnInit(){const i=!!this.data?.id;this.titulo=i?"Actualizar UNIDAD ORG\xc1NICA":"Agregar nueva UNIDAD ORG\xc1NICA",this.cargarEntidades(),this.uoForm.get("idEntidad")?.valueChanges.subscribe(e=>{e?this.cargarUnidadOrganica(e):(this.unidadorganicas=[],this.uoForm.get("idDependencia")?.setValue(null))}),i&&this.setFormValues(this.data)}setFormValues(i){this.uoForm.patchValue({idEntidad:i.idEntidad,descripcion:i.descripcion,idDependencia:i.idDependencia}),i.idDependencia?this.cargarUnidadOrganica(i.idEntidad,i.idDependencia):(this.unidadorganicas=[],this.uoForm.get("idDependencia")?.setValue(null))}cargarEntidades(){this.entidadService.getPaginadoEntidad("",1,100).subscribe({next:i=>{this.entidades=i.items,!this.uoForm.get("idEntidad")?.value&&this.entidades.length>0&&this.uoForm.get("idEntidad")?.setValue(this.entidades[0].id)},error:i=>console.error(i)})}cargarUnidadOrganica(i,e){this.unidadorganicaService.getPaginadoUnidadorganica("",1,100,i).subscribe({next:n=>{this.unidadorganicas=n.items,this.unidadorganicas.length>0&&e?this.uoForm.get("idDependencia")?.setValue(e):this.uoForm.get("idDependencia")?.setValue(null)},error:n=>console.error(n)})}onSubmit(){if(this.uoForm.valid){console.log("Formulario v\xe1lido:",this.uoForm.value);const{idEntidad:i,idDependencia:e,descripcion:n}=this.uoForm.value,o={idEntidad:i,...null!=e&&{idDependencia:e},descripcion:n},s=!!this.data?.id;console.log("esEdicion",s),console.log("dto",o),(s?this.unidadorganicaService.actualizarUnidadorganica(this.data.id,o):this.unidadorganicaService.agregarUnidadorganica(o)).subscribe({next:u=>{if(u.success){const C=s?h.I.successActualizar("ENTIDAD"):h.I.successCrear("ENTIDAD");this.notificationsService.success(...C),this.dialogRef.close(!!s||u.data)}else this._snackBar.open(u.errorMessage||"Error desconocido","Cerrar",{duration:3e3})},error:u=>{this._snackBar.open("Error del servidor","Cerrar",{duration:3e3}),console.error(u)}})}else console.log("Formulario inv\xe1lido"),this.uoForm.markAllAsTouched()}static#t=this.\u0275fac=function(e){return new(e||a)(t.rXU(p.Vh),t.rXU(y.UG),t.rXU(c.ok))};static#i=this.\u0275cmp=t.VBU({type:a,selectors:[["app-unidadorganica-edit"]],standalone:!0,features:[t.aNF],decls:28,vars:9,consts:[["mat-dialog-title","",1,"m-b-24"],[1,"mat-typography",2,"max-width","600px"],[3,"ngSubmit","formGroup"],["appearance","outline",1,"w-100"],["formControlName","idEntidad"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["formControlName","idDependencia"],["matInput","","formControlName","descripcion"],[1,"p-24"],["mat-flat-button","","color","primary",3,"click","mat-dialog-close","disabled"],["mat-stroked-button","","color","warn","mat-dialog-close",""],[3,"value"]],template:function(e,n){if(1&e&&(t.j41(0,"h2",0),t.EFF(1),t.k0s(),t.nrm(2,"mat-divider"),t.j41(3,"mat-dialog-content",1)(4,"form",2),t.bIt("ngSubmit",function(){return n.onSubmit()}),t.j41(5,"mat-form-field",3)(6,"mat-label"),t.EFF(7,"Entidad"),t.k0s(),t.j41(8,"mat-select",4),t.DNE(9,Mt,2,2,"mat-option",5),t.k0s(),t.DNE(10,Yt,2,0,"mat-error",6),t.k0s(),t.j41(11,"mat-form-field",3)(12,"mat-label"),t.EFF(13,"Unidad Org\xe1nica"),t.k0s(),t.j41(14,"mat-select",7),t.DNE(15,Qt,2,2,"mat-option",5),t.k0s(),t.DNE(16,Wt,2,0,"mat-error",6),t.k0s(),t.j41(17,"mat-form-field",3)(18,"mat-label"),t.EFF(19,"Descripci\xf3n"),t.k0s(),t.nrm(20,"input",8),t.DNE(21,Ht,2,0,"mat-error",6),t.k0s()()(),t.nrm(22,"mat-divider"),t.j41(23,"mat-dialog-actions",9)(24,"button",10),t.bIt("click",function(){return n.onSubmit()}),t.EFF(25," Guardar "),t.k0s(),t.j41(26,"button",11),t.EFF(27,"Cancelar"),t.k0s()()),2&e){let o,s,m;t.R7$(),t.JRh(n.titulo),t.R7$(3),t.Y8G("formGroup",n.uoForm),t.R7$(5),t.Y8G("ngForOf",n.entidades),t.R7$(),t.Y8G("ngIf",null==(o=n.uoForm.get("idEntidad"))?null:o.hasError("required")),t.R7$(5),t.Y8G("ngForOf",n.unidadorganicas),t.R7$(),t.Y8G("ngIf",null==(s=n.uoForm.get("idDependencia"))?null:s.hasError("required")),t.R7$(5),t.Y8G("ngIf",null==(m=n.uoForm.get("descripcion"))?null:m.hasError("required")),t.R7$(3),t.Y8G("mat-dialog-close",!0)("disabled",n.uoForm.invalid)}},dependencies:[F.G,b.wT,g.rl,g.nJ,g.TL,T.fg,zt.VO,$.q,U.$z,p.tx,p.BI,p.E7,p.Yi,c.YN,c.qT,c.me,c.BC,c.cb,b.WX,c.X1,c.j4,c.JD,A,E.X4,f.MD,f.Sq,f.bT],encapsulation:2,changeDetection:0})}return a})();var Jt=d(152),qt=d(3294),Zt=d(5558),Kt=d(5312);let ti=(()=>{class a{constructor(){this.baseUrl=Kt.c.baseUrl,this.http=(0,t.WQX)(w.Qq)}getPaginadoUnidadorgnicaUsuario(i,e="",n=1,o=10){return this.http.get(`${this.baseUrl}/api/usuarioUnidadOrganicas/unidadorganica/${i}/usuarios`,{params:{idUnidadorganica:i,search:e,Page:n,RecordsPerPage:o},observe:"response"}).pipe((0,j.T)(m=>({data:m.body?.data??[],meta:{total:parseInt(m.headers.get("totalrecordsquantity")??"0",10),page:n,pageSize:o}})))}agregarUnidadorganicaUsuario(i){return this.http.post(`${this.baseUrl}/api/usuarioUnidadOrganicas`,i)}actualizarUnidadorganicaUsuario(i,e){return this.http.put(`${this.baseUrl}/api/usuarioUnidadOrganicas/${i}`,e)}getUnidadorganicaUsuario(i,e){return this.http.get(`${this.baseUrl}/api/usuarioUnidadOrganicas/unidadorganica/${i}/usuario/${e}`)}static#t=this.\u0275fac=function(e){return new(e||a)};static#i=this.\u0275prov=t.jDH({token:a,factory:a.\u0275fac,providedIn:"root"})}return a})();const ii=(a,r)=>r.idUsuario,ai=()=>[10,15,20];function ei(a,r){if(1&a){const i=t.RV6();t.j41(0,"mat-list-option",11),t.bIt("selectedChange",function(n){const o=t.eBV(i).$implicit,s=t.XpG();return t.Njj(s.onSelectedChange(o,n))}),t.EFF(1),t.k0s()}if(2&a){const i=r.$implicit;t.Y8G("selected",!0===i.estado),t.R7$(),t.Lme(" ",i.numdoc," - ",i.descripcionPersona," ")}}let ni=(()=>{class a{constructor(i){this.data=i,this.uousuarioService=(0,t.WQX)(ti),this.notificationsService=(0,t.WQX)(k.I2),this.dialogRef=(0,t.WQX)(p.CP),this.snackBar=(0,t.WQX)(y.UG),this.unidadorganicaDescripcion="",this.usuarios=(0,t.vPA)([]),this.totalRecords=0,this.searchTerm="",this.currentPage=1,this.currentPageSize=10,this.isLoading=!1}ngOnInit(){this.unidadorganicaDescripcion=this.data?.descripcion,this.loadUnidadorganicaUsuarios(this.data?.id)}get seleccionadas(){return this.usuarios().filter(i=>i.estado).length}loadUnidadorganicaUsuarios(i,e="",n=1,o=10){this.usuarios.set([]),this.isLoading=!0,this.uousuarioService.getPaginadoUnidadorgnicaUsuario(i,e,n,o).subscribe({next:s=>{this.totalRecords=s.meta.total,this.usuarios.set(s.data),setTimeout(()=>{this.isLoading=!1},300)},error:s=>{console.error("Error al obtener aplicaciones",s),this.isLoading=!1}})}onSearch(i){this.searchTerm=i.trim(),this.loadUnidadorganicaUsuarios(this.data?.id,this.searchTerm,this.currentPage,this.currentPageSize)}onSelectedChange(i,e){if(this.isLoading)return;const n={idUnidadorganica:this.data?.id,idUsuario:i.idUsuario,estado:e};this.uousuarioService.getUnidadorganicaUsuario(n.idUnidadorganica,n.idUsuario).subscribe({next:o=>{const s=o.success&&null!=o.data?.id;(s?this.uousuarioService.actualizarUnidadorganicaUsuario(o.data.id,n):this.uousuarioService.agregarUnidadorganicaUsuario(n)).subscribe({next:u=>{if(u.success){const[C,V]=s?h.I.successActualizar("ENTIDAD-APLICACION"):h.I.successCrear("ENTIDAD-APLICACION");this.usuarios.update(O=>O.map(I=>I.idUsuario===i.idUsuario?{...I,estado:e}:I)),this.snackBar.open(V,"Cerrar",{duration:3e3})}else this.snackBar.open(u.errorMessage||"Error desconocido","Cerrar",{duration:3e3})},error:u=>{this.snackBar.open("Error del servidor","Cerrar",{duration:3e3}),console.error(u)}})},error:o=>{this.snackBar.open("Error al consultar aplicaci\xf3n","Cerrar",{duration:3e3}),console.error(o)}})}onPageChange(i){this.currentPage=i.pageIndex+1,this.currentPageSize=i.pageSize,this.loadUnidadorganicaUsuarios(this.data?.id,this.searchTerm,this.currentPage,this.currentPageSize)}static#t=this.\u0275fac=function(e){return new(e||a)(t.rXU(p.Vh))};static#i=this.\u0275cmp=t.VBU({type:a,selectors:[["app-unidadorganica-usuario"]],viewQuery:function(e,n){if(1&e&&(t.GBs(_.iy,5),t.GBs(v.B4,5)),2&e){let o;t.mGM(o=t.lsd())&&(n.paginator=o.first),t.mGM(o=t.lsd())&&(n.sort=o.first)}},standalone:!0,features:[t.aNF],decls:18,vars:6,consts:[["mat-dialog-title","",1,"m-b-24"],[1,"mat-typography",2,"max-width","600px"],["appearance","outline",1,"w-100","hide-hint"],["matInput","","placeholder","Buscar Aplicaci\xf3n",3,"keyup"],["matSuffix",""],["name","search",1,"icon-20"],[3,"selected"],[1,"mat-subtitle-2","f-w-600","p-16","bg-light-primary","rounded"],["showFirstLastButtons","",3,"page","length","pageSize","pageSizeOptions"],[1,"p-24"],["mat-stroked-button","","color","warn","mat-dialog-close",""],[3,"selectedChange","selected"]],template:function(e,n){1&e&&(t.j41(0,"h2",0),t.EFF(1),t.k0s(),t.nrm(2,"mat-divider"),t.j41(3,"mat-dialog-content",1)(4,"mat-form-field",2)(5,"input",3),t.bIt("keyup",function(s){return n.onSearch(s.target.value)}),t.k0s(),t.j41(6,"mat-icon",4),t.nrm(7,"i-tabler",5),t.k0s()(),t.j41(8,"mat-selection-list"),t.Z7z(9,ei,2,3,"mat-list-option",6,ii),t.k0s(),t.j41(11,"p",7),t.EFF(12),t.k0s(),t.j41(13,"mat-paginator",8),t.bIt("page",function(s){return n.onPageChange(s)}),t.k0s()(),t.nrm(14,"mat-divider"),t.j41(15,"mat-dialog-actions",9)(16,"button",10),t.EFF(17,"Cancelar"),t.k0s()()),2&e&&(t.R7$(),t.JRh(n.unidadorganicaDescripcion),t.R7$(8),t.Dyx(n.usuarios()),t.R7$(3),t.SpI(" Opciones seleccionadas: ",n.seleccionadas," "),t.R7$(),t.Y8G("length",n.totalRecords)("pageSize",10)("pageSizeOptions",t.lJ4(5,ai)))},dependencies:[f.MD,c.X1,c.YN,D.Fg,D.p6,D.oh,$.q,S.Hu,F.G,g.rl,g.yw,T.fg,U.$z,R.An,p.tx,p.BI,p.E7,p.Yi,_.iy,b.WX,A,E.X4,E.Jc],encapsulation:2,changeDetection:0})}return a})();var W=d(850);const oi=()=>[10,15,20];function ri(a,r){if(1&a&&(t.j41(0,"mat-option",32),t.EFF(1),t.k0s()),2&a){const i=r.$implicit;t.Y8G("value",i.descripcion),t.R7$(),t.SpI(" ",i.descripcion," ")}}function si(a,r){1&a&&(t.j41(0,"mat-option",33),t.EFF(1," Mostrando los primeros 10 resultados... "),t.k0s())}function ci(a,r){1&a&&(t.j41(0,"th",34),t.EFF(1," Descripci\xf3n "),t.k0s())}function di(a,r){if(1&a&&(t.j41(0,"td",35),t.EFF(1),t.k0s()),2&a){const i=r.$implicit;t.R7$(),t.SpI(" ",i.descripcion," ")}}function li(a,r){1&a&&(t.j41(0,"th",34),t.EFF(1," Entidad "),t.k0s())}function pi(a,r){if(1&a&&(t.j41(0,"td",35),t.EFF(1),t.k0s()),2&a){const i=r.$implicit;t.R7$(),t.SpI(" ",i.nombreEntidad," ")}}function mi(a,r){1&a&&(t.j41(0,"th",34),t.EFF(1," Dependencia "),t.k0s())}function ui(a,r){if(1&a&&(t.j41(0,"td",35),t.EFF(1),t.k0s()),2&a){const i=r.$implicit;t.R7$(),t.SpI(" ",i.nombreDependencia," ")}}function hi(a,r){1&a&&(t.j41(0,"th",34),t.EFF(1," Usuario(s) "),t.k0s())}function gi(a,r){if(1&a){const i=t.RV6();t.j41(0,"td",35)(1,"button",36),t.bIt("click",function(){const n=t.eBV(i).$implicit,o=t.XpG();return t.Njj(o.openDialogUsuario(n))}),t.EFF(2),t.k0s()()}if(2&a){const i=r.$implicit;t.R7$(2),t.SpI(" ",i.cantidadUsuarios," + Usuario(s) ")}}function fi(a,r){1&a&&(t.j41(0,"th",34),t.EFF(1," Estado "),t.k0s())}function _i(a,r){1&a&&t.nrm(0,"div",38)}function Ei(a,r){1&a&&(t.j41(0,"span",39),t.EFF(1,"Activo"),t.k0s())}function bi(a,r){1&a&&(t.j41(0,"span",40),t.EFF(1,"Inactivo"),t.k0s())}function Ci(a,r){if(1&a&&(t.j41(0,"td",35),t.DNE(1,_i,1,0,"div",37)(2,Ei,2,0,"ng-template",null,1,t.C5r)(4,bi,2,0,"ng-template",null,2,t.C5r),t.k0s()),2&a){const i=r.$implicit,e=t.sdS(3),n=t.sdS(5);t.R7$(),t.Y8G("ngIf",i.estado)("ngIfThen",e)("ngIfElse",n)}}function vi(a,r){1&a&&(t.j41(0,"th",34),t.EFF(1," Acciones "),t.k0s())}function Fi(a,r){if(1&a){const i=t.RV6();t.j41(0,"a",48),t.bIt("click",function(){t.eBV(i);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.habilitarUnidadorganica(n.id))}),t.nrm(1,"i-tabler",49),t.k0s()}}function ki(a,r){if(1&a){const i=t.RV6();t.j41(0,"a",50),t.bIt("click",function(){t.eBV(i);const n=t.XpG().$implicit,o=t.XpG();return t.Njj(o.deshabilitarUnidadorganica(n.id))}),t.nrm(1,"i-tabler",51),t.k0s()}}function Ti(a,r){if(1&a){const i=t.RV6();t.j41(0,"td",41)(1,"a",42),t.bIt("click",function(){const n=t.eBV(i).$implicit,o=t.XpG();return t.Njj(o.openDialog(n))}),t.nrm(2,"i-tabler",43),t.k0s(),t.j41(3,"a",44),t.bIt("click",function(){const n=t.eBV(i).$implicit,o=t.XpG();return t.Njj(o.eliminarUnidadorganica(n.id))}),t.nrm(4,"i-tabler",45),t.k0s(),t.DNE(5,Fi,2,0,"a",46)(6,ki,2,0,"a",47),t.k0s()}if(2&a){const i=r.$implicit;t.R7$(5),t.vxM(i.estado?6:5)}}function Ui(a,r){1&a&&t.nrm(0,"tr",52)}function Si(a,r){1&a&&t.nrm(0,"tr",53)}const Ii=[{path:"",children:[{path:"entidad",component:Tt,data:{title:"Entidad",urls:[{title:"Dashboard",url:"/dashboards/dashboard1"},{title:"Entidad"}]}},{path:"aplicacion",component:Ot,data:{title:"Aplicacion",urls:[{title:"Dashboard",url:"/dashboards/dashboard1"},{title:"Aplicacion"}]}},{path:"unidadOrganica",component:(()=>{class a{constructor(i,e){this.notificationsService=i,this.confirmationService=e,this.unidadorganicaService=(0,t.WQX)(Q),this.entidadService=(0,t.WQX)(x),this.dialog=(0,t.WQX)(p.bZ),this.displayedColumns=["descripcion","nombreEntidad","nombreDependencia","usuario","estado","actions"],this.dataSource=new l.I6,this.totalRecords=0,this.searchTerm="",this.selectedEntidad=null,this.firstControl=new c.MJ(""),this.firstoption=["One","Two","Three"]}ngOnInit(){this.loadUnidadorganicaes(),this.filteredOptions=this.firstControl.valueChanges.pipe((0,Jt.B)(300),(0,qt.F)(),(0,Zt.n)(i=>this.entidadService.getPaginadoEntidad(i,1,10).pipe((0,j.T)(e=>e.items))))}ngAfterViewInit(){this.paginator.page.subscribe(()=>{this.loadUnidadorganicaes(this.searchTerm,this.paginator.pageIndex+1,this.paginator.pageSize)})}loadUnidadorganicaes(i="",e=1,n=10,o){this.unidadorganicaService.getPaginadoUnidadorganica(i,e,n,o).subscribe({next:s=>{this.totalRecords=s.meta.total,this.dataSource.data=s.items},error:s=>{console.error("Error al obtener unidadorganicaes",s)}})}onSearch(i){this.searchTerm=i.trim(),this.paginator.firstPage(),this.loadUnidadorganicaes(this.searchTerm)}onEntidadSelected(i){this.entidadService.getPaginadoEntidad(i,1,10).subscribe({next:e=>{this.selectedEntidad=e.items.find(n=>n.descripcion===i)??null,this.selectedEntidad&&this.loadUnidadorganicaes("",1,10,this.selectedEntidad.id)}})}openDialog(i){this.dialog.open(Lt,{data:i??null,width:"600px",disableClose:!0}).afterClosed().subscribe(e=>{e&&this.loadUnidadorganicaes(this.searchTerm,this.paginator.pageIndex+1,this.paginator.pageSize)})}openDialogUsuario(i){this.dialog.open(ni,{data:i}).afterClosed().subscribe(()=>{this.loadUnidadorganicaes(this.searchTerm,this.paginator.pageIndex+1,this.paginator.pageSize)})}eliminarUnidadorganica(i){this.confirmationService.confirmAndExecute("\xa1No podr\xe1s revertir esto!",this.unidadorganicaService.eliminarUnidadorganica(i),e=>{e.success&&(this.notificationsService.success(...h.I.success()),this.loadUnidadorganicaes())})}deshabilitarUnidadorganica(i){this.confirmationService.confirmAndExecute("\xa1No podr\xe1s revertir esto!",this.unidadorganicaService.deshabilitarUnidadorganica(i),e=>{e.success&&(this.notificationsService.success(...h.I.success("Unidad Org\xe1nica Deshabilitada")),this.loadUnidadorganicaes())})}habilitarUnidadorganica(i){this.confirmationService.confirmAndExecute("\xa1No podr\xe1s revertir esto!",this.unidadorganicaService.habilitarUnidadorganica(i),e=>{e.success&&(this.notificationsService.success(...h.I.success("Unidad Org\xe1nica Habilitada")),this.loadUnidadorganicaes())})}static#t=this.\u0275fac=function(e){return new(e||a)(t.rXU(k.I2),t.rXU(P))};static#i=this.\u0275cmp=t.VBU({type:a,selectors:[["app-unidadorganica"]],viewQuery:function(e,n){if(1&e&&(t.GBs(_.iy,5),t.GBs(v.B4,5)),2&e){let o;t.mGM(o=t.lsd())&&(n.paginator=o.first),t.mGM(o=t.lsd())&&(n.sort=o.first)}},standalone:!0,features:[t.aNF],decls:48,vars:14,consts:[["auto","matAutocomplete"],["activo",""],["inactivo",""],[1,"cardWithShadow"],[1,"row","justify-content-between"],[1,"col-lg-4"],["appearance","outline",1,"w-100"],["type","text","placeholder","Buscar y Seleccionar Entidad","matInput","",3,"formControl","matAutocomplete"],["matSuffix",""],["name","search",1,"icon-20"],["autoActiveFirstOption","",3,"optionSelected"],[3,"value",4,"ngFor","ngForOf"],["disabled","",4,"ngIf"],["appearance","outline",1,"w-100","hide-hint"],["matInput","","placeholder","Buscar Unidad Organica",3,"keyup"],[1,"col-lg-4","d-flex","align-items-center","justify-content-end"],["mat-flat-button","","color","primary",3,"click"],[1,"table-responsive"],["mat-table","","matSort","",1,"w-100",3,"dataSource"],["matColumnDef","descripcion"],["mat-header-cell","","class","f-s-16 f-w-600",4,"matHeaderCellDef"],["mat-cell","","class","f-s-14",4,"matCellDef"],["matColumnDef","nombreEntidad"],["matColumnDef","nombreDependencia"],["matColumnDef","usuario"],[1,"flex","gap-2","justify-end","w-full"],["matColumnDef","estado"],["matColumnDef","actions"],["mat-cell","","class","action-link",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],["showFirstLastButtons","",3,"length","pageSizeOptions"],[3,"value"],["disabled",""],["mat-header-cell","",1,"f-s-16","f-w-600"],["mat-cell","",1,"f-s-14"],["mat-stroked-button","","color","primary",1,"m-l-auto",3,"click"],["class","d-flex align-items-center gap-12 p-y-14",4,"ngIf","ngIfThen","ngIfElse"],[1,"d-flex","align-items-center","gap-12","p-y-14"],[1,"bg-light-success","text-success","rounded","f-w-600","p-6","p-y-4","f-s-14"],[1,"bg-light-error","text-error","rounded","f-w-600","p-6","p-y-4","f-s-14"],["mat-cell","",1,"action-link"],["matTooltip","Editar","matTooltipPosition","above",1,"m-r-10","cursor-pointer",3,"click"],["name","edit",1,"icon-18"],["matTooltip","Eliminar","matTooltipPosition","below",1,"m-r-10","cursor-pointer",3,"click"],["name","trash",1,"icon-18"],["matTooltip","Habilitar","matTooltipPosition","above",1,"m-r-10","cursor-pointer"],["matTooltip","Deshabilitar","matTooltipPosition","right",1,"m-r-10","cursor-pointer"],["matTooltip","Habilitar","matTooltipPosition","above",1,"m-r-10","cursor-pointer",3,"click"],["name","circle-arrow-up",1,"icon-18"],["matTooltip","Deshabilitar","matTooltipPosition","right",1,"m-r-10","cursor-pointer",3,"click"],["name","circle-arrow-down",1,"icon-18"],["mat-header-row",""],["mat-row",""]],template:function(e,n){if(1&e){const o=t.RV6();t.j41(0,"mat-card",3)(1,"mat-card-content")(2,"div",4)(3,"div",5)(4,"mat-form-field",6),t.nrm(5,"input",7),t.j41(6,"mat-icon",8),t.nrm(7,"i-tabler",9),t.k0s(),t.j41(8,"mat-autocomplete",10,0),t.bIt("optionSelected",function(m){return t.eBV(o),t.Njj(n.onEntidadSelected(m.option.value))}),t.DNE(10,ri,2,2,"mat-option",11),t.nI1(11,"async"),t.DNE(12,si,2,0,"mat-option",12),t.nI1(13,"async"),t.k0s()()(),t.j41(14,"div",5)(15,"mat-form-field",13)(16,"input",14),t.bIt("keyup",function(m){return t.eBV(o),t.Njj(n.onSearch(m.target.value))}),t.k0s(),t.j41(17,"mat-icon",8),t.nrm(18,"i-tabler",9),t.k0s()()(),t.j41(19,"div",15)(20,"button",16),t.bIt("click",function(){return t.eBV(o),t.Njj(n.openDialog())}),t.EFF(21," Nuevo "),t.k0s()()()()(),t.j41(22,"mat-card",3)(23,"mat-card-content")(24,"div",17)(25,"table",18),t.qex(26,19),t.DNE(27,ci,2,0,"th",20)(28,di,2,1,"td",21),t.bVm(),t.qex(29,22),t.DNE(30,li,2,0,"th",20)(31,pi,2,1,"td",21),t.bVm(),t.qex(32,23),t.DNE(33,mi,2,0,"th",20)(34,ui,2,1,"td",21),t.bVm(),t.qex(35,24),t.DNE(36,hi,2,0,"th",20)(37,gi,3,1,"td",21),t.bVm(),t.j41(38,"div",25),t.qex(39,26),t.DNE(40,fi,2,0,"th",20)(41,Ci,6,3,"td",21),t.bVm(),t.qex(42,27),t.DNE(43,vi,2,0,"th",20)(44,Ti,7,1,"td",28),t.bVm(),t.k0s(),t.DNE(45,Ui,1,0,"tr",29)(46,Si,1,0,"tr",30),t.k0s(),t.nrm(47,"mat-paginator",31),t.k0s()()()}if(2&e){let o;const s=t.sdS(9);t.R7$(5),t.Y8G("formControl",n.firstControl)("matAutocomplete",s),t.R7$(5),t.Y8G("ngForOf",t.bMT(11,9,n.filteredOptions)),t.R7$(2),t.Y8G("ngIf",10===(null==(o=t.bMT(13,11,n.filteredOptions))?null:o.length)),t.R7$(13),t.Y8G("dataSource",n.dataSource),t.R7$(20),t.Y8G("matHeaderRowDef",n.displayedColumns),t.R7$(),t.Y8G("matRowDefColumns",n.displayedColumns),t.R7$(),t.Y8G("length",n.totalRecords)("pageSizeOptions",t.lJ4(13,oi))}},dependencies:[F.G,W.$3,b.wT,W.pN,g.rl,g.yw,T.fg,S.RN,S.m2,U.$z,R.An,X.oV,_.iy,v.B4,l.Zl,l.tL,l.ji,l.cC,l.YV,l.iL,l.KS,l.$R,l.YZ,l.NB,E.X4,E.Jc,b.WX,G.Id,f.MD,f.Sq,f.bT,f.Jj,_.Ou,c.YN,c.me,c.BC,c.X1,c.l_],styles:["[_nghost-%COMP%]{display:block}.mat-column-usuario[_ngcontent-%COMP%], .mat-column-estado[_ngcontent-%COMP%], .mat-column-actions[_ngcontent-%COMP%]{width:7%}"],changeDetection:0})}return a})(),data:{title:"UnidadOrganica",urls:[{title:"Dashboard",url:"/dashboards/dashboard1"},{title:"UnidadOrganica"}]}}]}]}}]);